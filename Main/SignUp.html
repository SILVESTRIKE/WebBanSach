<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/form.css" />
    <link rel="stylesheet" href="../css/onleffect.css" />
    <link rel="icon" href="../img/logokhongten.png" type="image/x-icon" />

    <title>DPS BOOKSHOP</title>
  </head>
  <header></header>
  <body>
    <div class="container">
      <div class="main">
        <h1>ĐĂNG KÝ</h1>
        <h4>
          Đã có tài khoản? <span><a href="SignIn.html">Đăng nhập</a></span> ở
          đây.
        </h4>
        <form id="sign-up-form" enctype="multipart/form-data">
          <table>
            <tr>
              <td>Tên:</td>
              <td>Họ:</td>
            </tr>
            <tr>
              <td><input type="text" id="Name" required /></td>
              <td><input type="text" id="Lastname" required /></td>
            </tr>
            <tr>
              <td>Ngày Sinh:</td>
              <td>
                <select name="DoB" id="Day" required>
                  <optgroup label="Ngày">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                  </optgroup>
                </select>
                <span class="slash">/</span>
                <select name="DoB" id="Month" required>
                  <optgroup label="Tháng">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                  </optgroup>
                </select>
                <span class="slash">/</span>
                <select name="DoB" id="Year" required>
                  <optgroup label="Năm">
                    <option value="1940">1940</option>
                    <option value="1941">1941</option>
                    <option value="1942">1942</option>
                    <option value="1943">1943</option>
                    <option value="1944">1944</option>
                    <option value="1945">1945</option>
                    <option value="1946">1946</option>
                    <option value="1947">1947</option>
                    <option value="1948">1948</option>
                    <option value="1949">1949</option>
                    <option value="1950">1950</option>
                    <option value="1951">1951</option>
                    <option value="1952">1952</option>
                    <option value="1953">1953</option>
                    <option value="1954">1954</option>
                    <option value="1955">1955</option>
                    <option value="1956">1956</option>
                    <option value="1957">1957</option>
                    <option value="1958">1958</option>
                    <option value="1959">1959</option>
                    <option value="1960">1960</option>
                    <option value="1961">1961</option>
                    <option value="1962">1962</option>
                    <option value="1963">1963</option>
                    <option value="1964">1964</option>
                    <option value="1965">1965</option>
                    <option value="1966">1966</option>
                    <option value="1967">1967</option>
                    <option value="1968">1968</option>
                    <option value="1969">1969</option>
                    <option value="1970">1970</option>
                    <option value="1971">1971</option>
                    <option value="1972">1972</option>
                    <option value="1973">1973</option>
                    <option value="1974">1974</option>
                    <option value="1975">1975</option>
                    <option value="1976">1976</option>
                    <option value="1977">1977</option>
                    <option value="1978">1978</option>
                    <option value="1979">1979</option>
                    <option value="1980">1980</option>
                    <option value="1981">1981</option>
                    <option value="1982">1982</option>
                    <option value="1983">1983</option>
                    <option value="1984">1984</option>
                    <option value="1985">1985</option>
                    <option value="1986">1986</option>
                    <option value="1987">1987</option>
                    <option value="1988">1988</option>
                    <option value="1989">1989</option>
                    <option value="1990">1990</option>
                    <option value="1991">1991</option>
                    <option value="1992">1992</option>
                    <option value="1993">1993</option>
                    <option value="1994">1994</option>
                    <option value="1995">1995</option>
                    <option value="1996">1996</option>
                    <option value="1997">1997</option>
                    <option value="1998">1998</option>
                    <option value="1999">1999</option>
                    <option value="2000">2000</option>
                    <option value="2001">2001</option>
                    <option value="2002">2002</option>
                    <option value="2003">2003</option>
                    <option value="2004">2004</option>
                    <option value="2005">2005</option>
                    <option value="2006">2006</option>
                    <option value="2007">2007</option>
                    <option value="2008">2008</option>
                    <option value="2009">2009</option>
                    <option value="2010">2010</option>
                    <option value="2011">2011</option>
                    <option value="2012">2012</option>
                    <option value="2013">2013</option>
                    <option value="2014">2014</option>
                    <option value="2015">2015</option>
                  </optgroup>
                </select>
              </td>
            </tr>
            <tr>
              <td>Giới tính:</td>
              <td>
                <input
                  type="radio"
                  class="gt"
                  name="sex"
                  value="Nam"
                  required
                /><label for="nam">Nam</label>
                <input
                  type="radio"
                  class="gt"
                  name="sex"
                  value="Nữ"
                  required
                /><label for="nu">Nữ</label>
              </td>
            </tr>
            <tr>
              <td>Vai trò:</td>
              <td>
                <input
                  type="radio"
                  class="role"
                  name="role"
                  value="Mua"
                  required
                /><label for="mua">Mua</label>
                <input
                  type="radio"
                  class="role"
                  name="role"
                  value="Bán"
                  required
                /><label for="ban">Bán</label>
              </td>
            </tr>
            <tr>
              <td>Số Điện Thoại:</td>
              <td><input type="tel" name="tel" id="tel" required /></td>
            </tr>
            <tr>
              <td>Email:</td>
              <td><input type="email" name="email" id="email" required /></td>
            </tr>
            <tr>
              <td>Địa chỉ:</td>
              <td>
                <input type="text" name="address" id="address" required />
              </td>
            </tr>
            <tr>
              <td>Mật khẩu:</td>
              <td><input type="password" id="password" required /></td>
            </tr>
            <tr>
              <td>Xác nhận mật khẩu:</td>
              <td><input type="password" id="confirm-password" required /></td>
            </tr>
            <tr>
              <td>Ảnh đại diện:</td>
              <td>
                <input type="file" id="avatar" accept="image/*" required />
              </td>
            </tr>
            <tr>
              <td colspan="2">
                <input type="checkbox" /> Tôi muốn nhận thông báo về sản phẩm và
                ưu đãi mới
              </td>
            </tr>
            <tr>
              <td colspan="2">
                <input type="checkbox" /> Tôi đồng ý với thỏa thuận và điều kiện
              </td>
            </tr>
            <tr>
              <td colspan="2">
                <button class="csbtn" type="submit">XÁC NHẬN</button>
              </td>
            </tr>
          </table>
        </form>
      </div>
    </div>
    <script src="loadNavbar.js"></script>
    <script src="customers.js"></script>

    <script>
      document
        .getElementById("sign-up-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const firstName = document.getElementById("Name").value;
          const lastName = document.getElementById("Lastname").value;
          const day = document.getElementById("Day").value;
          const month = document.getElementById("Month").value;
          const year = document.getElementById("Year").value;
          const sex = document.querySelector('input[name="sex"]:checked').value;
          const role = document.querySelector(
            'input[name="role"]:checked'
          ).value;
          const phone = document.getElementById("tel").value;
          const email = document.getElementById("email").value;
          const address = document.getElementById("address").value;
          const password = document.getElementById("password").value;
          const confirmPassword =
            document.getElementById("confirm-password").value;
          const avatar = document.getElementById("avatar").files[0];

          if (password !== confirmPassword) {
            alert("Passwords do not match!");
            return;
          }

          const reader = new FileReader();
          reader.onloadend = function () {
            const count =
              customers.filter((customer) => customer.role === role).length + 1;
            const idPrefix = role === "Mua" ? "USER" : "ADMIN";
            const newCustomer = {
              id: `${idPrefix}${count}`,
              ava: reader.result,
              firstname: firstName,
              lastname: lastName,
              doB: `${year}-${month}-${day}`,
              sex: sex,
              phone: phone,
              email: email,
              password: password,
              address: address,
              role: role,
            };

            addCustomer(newCustomer);
            alert("User registered successfully!");

            window.location.href = "SignIn.html";
          };
          reader.readAsDataURL(avatar);
        });
    </script>
  </body>
</html>
